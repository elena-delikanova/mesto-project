(()=>{"use strict";var t={483:(t,e,o)=>{t.exports=o.p+"c15cb08ab8ecfaba54c6.jpg"},100:(t,e,o)=>{t.exports=o.p+"e25ed97c4c82eea0f732.jpg"},53:(t,e,o)=>{t.exports=o.p+"604ece1024502be03108.jpg"},510:(t,e,o)=>{t.exports=o.p+"c9d40e57f21cdd7e2e9e.jpg"},216:(t,e,o)=>{t.exports=o.p+"15f15923ae021e2c405b.jpg"},938:(t,e,o)=>{t.exports=o.p+"57d2d00be48246c13d4b.jpg"},841:(t,e,o)=>{t.exports=o.p+"ce3a80ec879161dfaca2.jpg"}},e={};function o(n){var r=e[n];if(void 0!==r)return r.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,o),a.exports}o.m=t,o.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),o.p="",o.b=document.baseURI||self.location.href,(()=>{new URL(o(100),o.b),new URL(o(53),o.b),new URL(o(510),o.b),new URL(o(216),o.b),new URL(o(938),o.b),new URL(o(841),o.b);var t="https://nomoreparties.co/v1/plus-cohort-14",e=function(t){if("Escape"===t.key){var e=document.querySelector(".popup_opened");e&&c(e)}},n=function(t){t.target.classList.contains("popup")&&c(t.target)},r=function(t){c(t.target.closest(".popup"))};function a(t){t.classList.add("popup_opened"),t.addEventListener("click",n),document.addEventListener("keydown",e)}function c(t){t.classList.remove("popup_opened"),t.removeEventListener("click",n),document.removeEventListener("keydown",e)}var i={authorization:"8fa0e13a-d0e0-42e8-8028-4ced854c725e","Content-Type":"application/json"},u=function(t){return t.ok?t.json():Promise.reject("Ошибка: ".concat(t.status))},l=document.querySelector(".popup-photo"),s=document.querySelector("#photo-card").content,d=l.querySelector(".popup-photo__photo"),p=l.querySelector(".popup-photo__photo-caption");function f(e,o,n){var r=e.name,c=e.link,f=e.likes,m=e._id,v=e.owner,h=s.querySelector(".photos__photo-card").cloneNode(!0),y=h.querySelector(".photos__photo"),b=h.querySelector(".photos__photo-caption"),_=h.querySelector(".photos__delete-button"),S=h.querySelector(".photos__like-button"),E=h.querySelector(".photos__like-counter"),q="photos__like-button_active",L=v._id===o;return y._id=m,b.textContent=r,y.src=c,y.alt="Фотография ".concat(r),y.addEventListener("click",(function(){d.src=c,d.alt="Фотография ".concat(r),p.textContent=r,p.style.width=d.clientWidth+"px",a(l)})),L?_.addEventListener("click",n):_.remove(),E.textContent=f.length,o&&f.some((function(t){return t._id===o}))&&S.classList.add(q),S.addEventListener("click",(function(){var e;S.classList.contains(q)?(e=m,fetch("".concat(t,"/cards/likes/").concat(e),{method:"DELETE",headers:i}).then(u)).then((function(t){E.textContent=t.likes.length,S.classList.remove(q)})).catch((function(t){console.log(t)})):function(e){return console.log(e),fetch("".concat(t,"/cards/likes/").concat(e),{method:"PUT",headers:i}).then(u)}(m).then((function(t){E.textContent=t.likes.length,S.classList.add(q)})).catch((function(t){console.log(t)}))})),h}function m(t){var e=t.inputList,o=t.buttonElement,n=t.validationParams;!function(t){return t.some((function(t){return!t.validity.valid}))}(e)?(o.classList.remove(n.inactiveButtonClass),o.disabled=!1):v({buttonElement:o,inactiveButtonClass:n.inactiveButtonClass})}function v(t){var e=t.buttonElement,o=t.inactiveButtonClass;e.classList.add(o),e.disabled=!0}function h(t){var e=t.element,o=t.buttonSelector,n=t.inactiveButtonClass;v({buttonElement:e.querySelector(o),inactiveButtonClass:n})}function y(t){t.objectToSet.addEventListener(t.event,t.handler)}function b(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}var _,S,E,q=document.querySelector(".add-photo-form"),L=document.querySelector(".popup-add-photo"),C=document.querySelector(".profile__name"),g=document.querySelector(".profile__caption"),x=document.querySelector(".profile__add-button"),k=document.querySelectorAll(".popup__close-button"),j=document.querySelector(".profile__edit-button"),T=document.querySelector(".popup-edit-info"),w=document.querySelector(".photos__gallary"),B=document.querySelector(".popup-update-avatar"),A=document.querySelector(".profile__avatar-edit-button"),P=document.querySelector(".popup-confirmation"),U=P.querySelector(".confirmation-form"),O=q.querySelector("#photo-capture"),R=q.querySelector("#photo-link"),I=T.querySelector(".edit-form"),D=I.querySelector("#profile-name"),M=I.querySelector("#profile-caption"),N=B.querySelector(".update-avatar-form"),J=N.querySelector("#update-avatar-link"),H=document.querySelector(".profile__avatar"),V=document.querySelector(".loader"),z=document.querySelector(".popup-error"),W=function(t){console.log(t),a(z)},$=function(t){S=t.target.closest(".photos__photo-card"),a(P)};function F(t){var e=t.card;t.container.prepend(e)}function G(t){var e=t.isLoading,o=t.button,n=t.initialButtonText;o.textContent=e?"Сохранение...":n}Promise.all([fetch("".concat(t,"/users/me"),{headers:i}).then(u),fetch("".concat(t,"/cards"),{headers:i}).then(u)]).then((function(t){var e,n,r=(n=2,function(t){if(Array.isArray(t))return t}(e=t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var n,r,a=[],c=!0,i=!1;try{for(o=o.call(t);!(c=(n=o.next()).done)&&(a.push(n.value),!e||a.length!==e);c=!0);}catch(t){i=!0,r=t}finally{try{c||null==o.return||o.return()}finally{if(i)throw r}}return a}}(e,n)||function(t,e){if(t){if("string"==typeof t)return b(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Object"===o&&t.constructor&&(o=t.constructor.name),"Map"===o||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?b(t,e):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()),a=r[0],c=r[1];C.textContent=a.name,g.textContent=a.about,H.src=a.avatar,H.onerror=function(){H.src=new URL(o(483),o.b)},_=a._id,c.reverse().forEach((function(t){F({card:f(t,_,$),container:w})}))})).catch((function(t){console.log(t)})).finally((function(){V.classList.add("loader-invisible")})),k.forEach((function(t){y({objectToSet:t,handler:r,event:"click"})})),y({objectToSet:q,handler:function(e){e.preventDefault();var o,n=e.submitter,r=n.textContent;G({isLoading:!0,button:n}),(o={name:O.value,link:R.value},fetch("".concat(t,"/cards"),{method:"POST",headers:i,body:JSON.stringify(o)}).then(u)).then((function(t){F({card:f(t,_),container:w}),c(L)})).catch(W).finally((function(){G({isLoading:!1,button:n,initialButtonText:r})}))},event:"submit"}),y({objectToSet:I,handler:function(e){e.preventDefault();var o,n=e.submitter,r=n.textContent;G({isLoading:!0,button:n}),(o={name:D.value,about:M.value},fetch("".concat(t,"/users/me"),{method:"PATCH",headers:i,body:JSON.stringify(o)}).then(u)).then((function(t){C.textContent=t.name,g.textContent=t.about,c(T)})).catch(W).finally((function(){G({isLoading:!1,button:n,initialButtonText:r})}))},event:"submit"}),y({objectToSet:N,handler:function(e){e.preventDefault();var o,n=e.submitter,r=n.textContent;(o=J.value,fetch("".concat(t,"/users/me/avatar"),{method:"PATCH",headers:i,body:JSON.stringify({avatar:o})}).then(u)).then((function(t){H.src=t.avatar,c(B)})).catch(W).finally((function(){G({isLoading:!1,button:n,initialButtonText:r})}))},event:"submit"}),y({objectToSet:U,handler:function(){var e;(e=S.querySelector(".photos__photo")._id,fetch("".concat(t,"/cards/").concat(e),{method:"DELETE",headers:i}).then(u)).then((function(){S.remove(),S=void 0,c(P)})).catch(W)},event:"submit"}),y({objectToSet:x,handler:function(){q.reset(),h({element:q,buttonSelector:".form__save-button",inactiveButtonClass:"form__save-button_inactive"}),a(L)},event:"click"}),y({objectToSet:j,handler:function(){D.value=C.textContent,M.value=g.textContent,h({element:I,buttonSelector:".form__save-button",inactiveButtonClass:"form__save-button_inactive"}),a(T)},event:"click"}),y({objectToSet:A,handler:function(){N.reset(),h({element:N,buttonSelector:".form__save-button",inactiveButtonClass:"form__save-button_inactive"}),a(B)},event:"click"}),E={formSelector:".form",fieldsetSelector:".form__set",inputSelector:".form__input",submitButtonSelector:".form__save-button",inactiveButtonClass:"form__save-button_inactive",inputErrorClass:"form__input_type_error",activeInputErrorClass:"form__input-error_active"},Array.from(document.querySelectorAll(E.formSelector)).forEach((function(t){t.addEventListener("submit",(function(t){t.preventDefault()})),Array.from(t.querySelectorAll(E.fieldsetSelector)).forEach((function(t){!function(t,e){var o=Array.from(t.querySelectorAll(e.inputSelector)),n=t.querySelector(e.submitButtonSelector);m({inputList:o,buttonElement:n,validationParams:e}),o.forEach((function(r){r.addEventListener("input",(function(){(function(t){var e,o,n,r,a;t.inputElement.validity.valid?(o=(e=t).formElement,n=e.inputElement,r=e.validationParams,a=o.querySelector(".".concat(n.id,"-error")),n.classList.remove(r.inputErrorClass),a.classList.remove(r.activeInputErrorClass),a.textContent=""):(t.inputElement.validity.patternMismatch?t.inputElement.setCustomValidity(t.inputElement.dataset.errorMessage):t.inputElement.setCustomValidity(""),function(t){var e=t.formElement,o=t.inputElement,n=t.validationParams,r=e.querySelector(".".concat(o.id,"-error"));o.classList.add(n.inputErrorClass),r.textContent=o.validationMessage,r.classList.add(n.activeInputErrorClass)}(t))})({formElement:t,inputElement:r,validationParams:e}),m({inputList:o,buttonElement:n,validationParams:e})}))}))}(t,E)}))}))})()})();